var Nt=Object.defineProperty;var pe=l=>{throw TypeError(l)};var Kt=(l,d,b)=>d in l?Nt(l,d,{enumerable:!0,configurable:!0,writable:!0,value:b}):l[d]=b;var $=(l,d,b)=>Kt(l,typeof d!="symbol"?d+"":d,b),Gt=(l,d,b)=>d.has(l)||pe("Cannot "+b);var q=(l,d,b)=>(Gt(l,d,"read from private field"),b?b.call(l):d.get(l)),fe=(l,d,b)=>d.has(l)?pe("Cannot add the same private member more than once"):d instanceof WeakSet?d.add(l):d.set(l,b);(function(){"use strict";const l=window.Vue;function d(){return window.panel}function b(){return d().api}const U=()=>window.panel.plugins.viewButtons!==void 0;function he(){return U()?new Proxy({},{get(){throw new Error("Vuex store is not available. Are you using Kirby 5? Use the `useContent` composable instead.")}}):d().app.$store}function N(){const s=d(),t=he(),n=U();if(n&&!("diff"in s.content))throw new Error("This plugin requires Kirby 5.0.0-rc.1 or higher. Please update your Kirby installation.");const e=x(n?()=>s.content.version("changes"):()=>t.getters["content/values"]()),r=x(n?()=>s.content.diff():()=>t.getters["content/changes"]()),o=x(n?()=>s.content.hasDiff():()=>t.getters["content/hasChanges"]()),i=n?s.content:new Proxy({},{get(){return()=>{}}});return{content:i,currentContent:e,contentChanges:r,hasChanges:o,update:async(c,p=!0)=>{if(!n&&c)for(const[h,u]of Object.entries(c))t.dispatch("content/update",[h,u]);const g=i.merge(c);p&&await i.save(g)}}}function ge(){const s=d();function t(n){return!n||typeof n=="string"?n:n[s.translation.code]??Object.values(n)[0]}return{t}}function me(){const s=b();return{load:({parent:n,name:e})=>s.get(`${n}/sections/${e}`)}}const ye={error:0,warn:1,log:2,info:3,success:3};function ve(s){const t=new be;return new Proxy({},{get(n,e){return(...r)=>{t.log({level:ye[e],type:e,tag:s,args:r})}}})}class be{constructor(){$(this,"defaultColor","#7f8c8d");$(this,"levelColorMap",{0:"#c0392b",1:"#f39c12",3:"#00BCD4"});$(this,"typeColorMap",{success:"#2ecc71"})}log(t){const n=_e(t.level),e=t.type==="log"?"":t.type,r=t.tag||"",i=`
background: ${this.typeColorMap[t.type]||this.levelColorMap[t.level]||this.defaultColor};
border-radius: 0.5em;
color: white;
font-weight: bold;
padding: 2px 0.5em;
`.trimStart(),a=`%c${[r,e].filter(Boolean).join(":")}`;typeof t.args[0]=="string"?n(`${a}%c ${t.args[0]}`,i,"",...t.args.slice(1)):n(a,i,...t.args)}}function _e(s){return s<1?console.error:console.log}const P=[],K=new Map;async function ke(s){if(!Array.isArray(s))throw new TypeError(`Expected an array, got ${typeof s}`);for(const t of s)P.some(n=>n.filename===t.filename)||P.push(t)}function X(s){if(P.length===0)throw new Error("Plugin assets not registered");const t=P.find(n=>n.filename===s);if(!t)throw new Error(`Plugin asset "${s}" not found`);return t}async function Q(s){if(s.endsWith(".js")||(s+=".js"),K.has(s))return K.get(s);const n=await import(X(s).url);return K.set(s,n),n}const x=l.computed;l.customRef,l.defineAsyncComponent,l.defineComponent,l.effectScope,l.getCurrentInstance,l.getCurrentScope,l.h,l.inject,l.isProxy,l.isReactive,l.isReadonly,l.isRef,l.isShallow,l.markRaw,l.nextTick,l.onActivated,l.onBeforeMount,l.onBeforeUnmount,l.onBeforeUpdate,l.onDeactivated,l.onErrorCaptured;const Ae=l.onMounted;l.onRenderTracked,l.onRenderTriggered,l.onScopeDispose,l.onServerPrefetch,l.onUnmounted,l.onUpdated,l.provide,l.proxyRefs,l.reactive,l.readonly;const y=l.ref;l.shallowReactive,l.shallowReadonly,l.shallowRef;const Se=l.toRaw;l.toRef,l.toRefs,l.triggerRef;const ee=l.unref;l.useAttrs,l.useCssModule,l.useCssVars,l.useListeners,l.useSlots;const we=l.watch;l.watchEffect,l.watchPostEffect,l.watchSyncEffect;const G={en:{"modal.info":"Thanks for purchasing {label}! Please enter your email address and order ID to activate your license.","modal.fields.orderId.help":'<a href="https://app.lemonsqueezy.com/my-orders" target="_blank">Find your order number</a> on Lemon Squeezy or <a href="mailto:hello@kirby.tools">contact us</a> if you cannot find it.',"modal.error.required.fields":"Email address and order ID are required","modal.error.invalid.unauthorized":"Email address or order ID is incorrect","modal.error.invalid.licenseKey":"License key invalid for this plugin","modal.error.incompatible":"License key invalid for this plugin version","modal.error.upgradeable":"License key invalid for this plugin version. Upgrade now on https://hub.kirby.tools.","modal.error.activated":"License key already activated",activate:"Activate",activated:"Plugin activated",buy:"Buy a license",upgrade:"Upgrade"},de:{"modal.info":"Dankeschön für den Kauf von {label}! Bitte gib deine E-Mail-Adresse und Bestellnummer ein, um deine Lizenz zu aktivieren.","modal.fields.orderId.help":'<a href="https://app.lemonsqueezy.com/my-orders" target="_blank">Finde deine Bestellnummer</a> bei Lemon Squeezy oder <a href="mailto:hello@kirby.tools">kontaktiere uns</a>, wenn du sie nicht finden kannst.',"modal.error.required.fields":"E-Mail-Adresse und Bestellnummer sind notwendig","modal.error.invalid.unauthorized":"E-Mail-Adresse oder Bestellnummer ist falsch","modal.error.invalid.licenseKey":"Lizenzschlüssel ungültig für dieses Plugin","modal.error.incompatible":"Lizenzschlüssel ungültig für diese Plugin-Version","modal.error.upgradeable":"Lizenzschlüssel ungültig für diese Plugin-Version. Aktualisiere jetzt auf https://hub.kirby.tools.","modal.error.activated":"Lizenzschlüssel bereits aktiviert",activate:"Aktivieren",activated:"Plugin aktiviert",buy:"Lizenz kaufen",upgrade:"Upgrade"},fr:{"modal.info":"Merci d'avoir acheté {label} ! Veuillez saisir votre adresse e-mail et votre numéro de commande pour activer votre licence.","modal.fields.orderId.help":'<a href="https://app.lemonsqueezy.com/my-orders" target="_blank">Trouvez votre numéro de commande</a> sur Lemon Squeezy ou <a href="mailto:hello@kirby.tools">contactez-nous</a> si vous ne le trouvez pas.',"modal.error.required.fields":"Adresse e-mail et numéro de commande requis","modal.error.invalid.unauthorized":"Adresse e-mail ou numéro de commande incorrect","modal.error.invalid.licenseKey":"Clé de licence invalide pour ce plugin","modal.error.incompatible":"Clé de licence invalide pour cette version du plugin","modal.error.upgradeable":"Clé de licence invalide pour cette version du plugin. Mettez à niveau maintenant sur https://hub.kirby.tools.","modal.error.activated":"Clé de licence déjà activée",activate:"Activer",activated:"Plugin activé",buy:"Acheter une licence",upgrade:"Upgrade"},nl:{"modal.info":"Bedankt voor het kopen van {label}! Voer je e-mailadres en bestelnummer in om je licentie te activeren.","modal.fields.orderId.help":'<a href="https://app.lemonsqueezy.com/my-orders" target="_blank">Vind je bestelnummer</a> op Lemon Squeezy of <a href="mailto:hello@kirby.tools">neem contact met ons op</a> als je het niet kunt vinden.',"modal.error.required.fields":"E-mailadres en bestelnummer zijn verplicht","modal.error.invalid.unauthorized":"E-mailadres of bestelnummer is onjuist","modal.error.invalid.licenseKey":"Licentiesleutel ongeldig voor dit plug-in","modal.error.incompatible":"Licentiesleutel ongeldig voor deze plug-inversie","modal.error.upgradeable":"Licentiesleutel ongeldig voor deze plug-inversie. Upgrade nu op https://hub.kirby.tools.","modal.error.activated":"Licentiesleutel al geactiveerd",activate:"Activeren",activated:"Plugin geactiveerd",buy:"Koop een licentie",upgrade:"Upgrade"}},xe=["localhost","127.0.0.1","[::1]"],Le=["local","test","ddev.site"];function R(s="",t){var r;const n=window.panel.translation.code,e=((r=G==null?void 0:G[n])==null?void 0:r[s])??s;return t?$e(e,t):e}function $e(s,t,n){return s.replace(/\{(\w+)\}/g,(e,r)=>t[r]||r)}function ze(){const{hostname:s}=window.location,t=xe.includes(s),n=Le.some(e=>s.endsWith(`.${e}`));return t||n}const te={Unauthorized:"modal.error.invalid.unauthorized","License key not valid for this plugin":"modal.error.invalid.licenseKey","License key not valid for this plugin version":"modal.error.incompatible","License key not valid for this plugin version, please upgrade your license":"modal.error.upgradeable","License key already activated":"modal.error.activated"};function Ce(s){const t=d();return{isLocalhost:ze(),assertActivationIntegrity:async({component:o,licenseStatus:i})=>{if(ee(i)==="active")return;const a=ee(o);if(!(a!=null&&a.$el)||window.getComputedStyle(a.$el).display==="none"||window.getComputedStyle(a.$el).visibility==="hidden"||window.getComputedStyle(a.$el).opacity==="0")throw new Error("Are you trying to hide the activation buttons? Please buy a license.")},openLicenseModal:()=>{let o=!1;const{label:i}=s,a={info:{type:"info",text:R("modal.info",{label:i})},email:{label:t.t("email"),type:"email"},orderId:{label:"Order ID",type:"text",help:R("modal.fields.orderId.help",{label:i})}};return new Promise(c=>{t.dialog.open({component:"k-form-dialog",props:{submitButton:{icon:"check",theme:"love",text:R("activate",{label:i})},fields:a},on:{close:()=>{c({isLicenseActive:o})},submit:async p=>{o=await Re(p,s),o&&(t.dialog.close(),t.notification.success(R("activated")))}}})})}}}async function Re(s,t){const n=d(),{email:e,orderId:r}=s;if(!e||!r)return n.notification.error(R("modal.error.required.fields")),!1;try{const o=await n.api.post(`${t.apiNamespace}/activate`,{email:e,orderId:Number(r)});if((o==null?void 0:o.status)!=="ok")throw new Error("Failed to activate license key");return!0}catch(o){const i=o.message;return n.notification.error(te[i]?R(te[i]):i),!1}}const Ee=Vue.defineComponent({__name:"LicensingButtonGroup",props:{label:{type:String,required:!0},apiNamespace:{type:String,required:!0},licenseStatus:{type:String,required:!0},pricingUrl:{type:String,required:!0}},setup(s){const t=s,{openLicenseModal:n,assertActivationIntegrity:e}=Ce({label:t.label,apiNamespace:t.apiNamespace}),r=y(t.licenseStatus),o=y();Ae(()=>{e({component:o,licenseStatus:t.licenseStatus})});async function i(){const{isLicenseActive:a}=await n();a&&window.location.reload()}return{__sfc:!0,props:t,openLicenseModal:n,assertActivationIntegrity:e,currentLicenseStatus:r,licenseButtonGroup:o,handleRegistration:i,t:R}}});function E(s,t,n,e,r,o,i,a){var c=typeof s=="function"?s.options:s;return t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),{exports:s,options:c}}var Oe=function(){var t=this,n=t._self._c,e=t._self._setupProxy;return e.currentLicenseStatus!=="active"?n("k-button-group",{ref:"licenseButtonGroup",attrs:{layout:"collapsed"}},[n("k-button",{attrs:{theme:"love",variant:"filled",size:"xs",link:e.currentLicenseStatus==="upgradeable"?"https://hub.kirby.tools":t.pricingUrl,target:"_blank",text:e.currentLicenseStatus==="upgradeable"?e.t("upgrade"):e.t("buy")}}),n("k-button",{attrs:{theme:"love",variant:"filled",size:"xs",icon:"key",text:e.t("activate")},on:{click:function(r){return e.handleRegistration()}}})],1):t._e()},Be=[],je=E(Ee,Oe,Be);const ne=je.exports;let Te;function Ie(){return Te??(Te=ve("seo-audit"))}const qe=["singleH1"],Pe=["functionWordsInKeyphrase","introductionKeyword","keyphraseDensity","keyphraseDistribution","keyphraseInSEOTitle","keyphraseLength","metaDescriptionKeyword","slugKeyword","subheadingsKeyword"],Me={wordComplexity:["de","en","es","fr"],keyphraseDistribution:["ar","cs","de","el","en","es","fr","he","hu","id","it","ja","nl","no","pl","pt","ru","sk","sv","tr"],metaDescriptionLength:["ar","cs","de","el","en","es","fa","fr","he","hu","id","it","ja","nl","no","pl","pt","ru","sk","sv","tr"],textParagraphTooLong:["ar","cs","de","el","en","es","fa","fr","he","hu","id","it","ja","nl","no","pl","pt","ru","sk","sv","tr"],textSentenceLength:["ar","cs","de","el","en","es","fa","fr","he","hu","id","it","ja","nl","no","pl","pt","ru","sk","sv","tr"],passiveVoice:["ar","cs","de","el","en","es","fa","fr","he","hu","id","it","nl","no","pl","pt","ru","sk","sv","tr"],textTransitionWords:["ar","ca","cs","de","el","en","es","fa","fr","he","hu","id","it","ja","nl","no","pl","pt","ru","sk","sv","tr"],functionWordsInKeyphrase:["ar","cs","de","el","en","es","fa","fr","he","hu","id","it","ja","nl","no","pl","pt","ru","sk","sv","tr"]},W=Object.freeze({af:"af-ZA",am:"am-ET",ar:"ar-SA",be:"be-BY",bg:"bg-BG",bn:"bn-BD",ca:"ca-ES",cs:"cs-CZ",da:"da-DK",de:"de-DE",el:"el-GR",en:"en-US",es:"es-ES",et:"et-EE",fa:"fa-IR",fi:"fi-FI",fr:"fr-FR",he:"he-IL",hi:"hi-IN",hr:"hr-HR",hu:"hu-HU",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lt:"lt-LT",lv:"lv-LV",ms:"ms-MY",nl:"nl-NL",no:"nb-NO",pl:"pl-PL",pt:"pt-BR",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",sr:"sr-RS",sv:"sv-SE",sw:"sw-TZ",th:"th-TH",tr:"tr-TR",uk:"uk-UA",ur:"ur-PK",vi:"vi-VN",zh:"zh-CN"}),De="__seo-audit__/context",M=["error","warn","info","debug"],He="kirby$seo-audit$";let D,T;function V(){return D||T||(T=window.panel.api.get(De).then(s=>(ke(s.assets),D=s,T=void 0,D)),T)}const Fe={altAttribute:{_label:"Alt-Attribut für Bilder",na:"Der Text enthält keine Bilder.",none:"Keines der {imagesWithoutAltAttribute} Bilder enthält ein Attribut für alternativen Text. Fügen Sie sie hinzu!",some:"Einige der {imagesWithoutAltAttribute} Bilder enthalten ein Attribut für alternativen Text. Fügen Sie sie hinzu!",every:"Alle Bilder enthalten ein Attribut für alternativen Text. Gute Arbeit!"},headingStructureOrder:{_label:"Reihenfolge der Überschriften",sequential:"Die Überschriftenstruktur ist in sequenzieller Reihenfolge. Gute Arbeit!",nonSequential:"Die Überschriftenstruktur ist nicht in sequenzieller Reihenfolge. Korrigieren Sie Ihre Überschriftenstruktur!"},singleH1:{_label:"Einzelne H1",one:"Der Text enthält einen H1-Tag. Gute Arbeit!",multiple:"Der Text enthält mehrere H1-Tags. Überdenken Sie Ihre Überschriftenstruktur!",none:"Der Text enthält keinen H1-Tag. Fügen Sie ihn hinzu!"}},Ue={altAttribute:{_label:"Image alt attribute",na:"The text doesn't contain any images.",none:"None of the {imagesWithoutAltAttribute} images contain an alternative text attribute. Add them!",some:"Some of the {imagesWithoutAltAttribute} images contain an alternative text attribute. Add them!",every:"All images contain an alternative text attribute. Good job!"},headingStructureOrder:{_label:"Heading structure",sequential:"The heading structure is in sequential order. Good job!",nonSequential:"The heading structure is not in sequential order. Fix your heading structure!"},singleH1:{_label:"Single H1",one:"The text contains a single H1 tag. Good job!",multiple:"The text contains multiple H1 tags. Rethink your heading structure!",none:"The text contains no H1 tag. Add it!"}},Ne={altAttribute:{_label:"Atributo alt de imágenes",na:"El texto no contiene ninguna imagen.",none:"Ninguna de las {imagesWithoutAltAttribute} imágenes contiene un atributo de texto alternativo. ¡Añádelos!",some:"Algunas de las {imagesWithoutAltAttribute} imágenes contienen un atributo de texto alternativo. ¡Añádelos!",every:"Todas las imágenes contienen un atributo de texto alternativo. ¡Buen trabajo!"},headingStructureOrder:{_label:"Estructura de encabezados",sequential:"La estructura de encabezados está en orden secuencial. ¡Buen trabajo!",nonSequential:"La estructura de encabezados no está en orden secuencial. ¡Corrige tu estructura de encabezados!"},singleH1:{_label:"H1 único",one:"El texto contiene una sola etiqueta H1. ¡Buen trabajo!",multiple:"El texto contiene múltiples etiquetas H1. ¡Reconsider tu estructura de encabezados!",none:"El texto no contiene ninguna etiqueta H1. ¡Añádela!"}},Ke={altAttribute:{_label:"Attribut alt des images",na:"Le texte ne contient aucune image.",none:"Aucune des {imagesWithoutAltAttribute} images ne contient un attribut de texte alternatif. Ajoutez-les !",some:"Certaines des {imagesWithoutAltAttribute} images contiennent un attribut de texte alternatif. Ajoutez-les !",every:"Toutes les images contiennent un attribut de texte alternatif. Bon travail !"},headingStructureOrder:{_label:"Structure des titres",sequential:"La structure des titres est dans l'ordre séquentiel. Bon travail !",nonSequential:"La structure des titres n'est pas dans l'ordre séquentiel. Corrigez votre structure de titres !"},singleH1:{_label:"H1 unique",one:"Le texte contient un seul tag H1. Bon travail !",multiple:"Le texte contient plusieurs tags H1. Repensez votre structure de titres !",none:"Le texte ne contient aucun tag H1. Ajoutez-le !"}},Ge={altAttribute:{_label:"Alt-tekst voor afbeeldingen",na:"De tekst bevat geen afbeeldingen.",none:"Geen van de {imagesWithoutAltAttribute} afbeeldingen bevat alt-tekst. Voeg ze toe!",some:"Sommige van de {imagesWithoutAltAttribute} afbeeldingen bevatten alt-tekst. Voeg ze toe!",every:"Alle afbeeldingen bevatten alt-tekst. Goed gedaan!"},headingStructureOrder:{_label:"Kopstructuur volgorde",sequential:"De kopstructuur is in opeenvolgende volgorde. Goed gedaan!",nonSequential:"De kopstructuur is niet in opeenvolgende volgorde. Corrigeer je kopstructuur!"},singleH1:{_label:"Enkele H1",one:"De tekst bevat één H1-tag. Goed gedaan!",multiple:"De tekst bevat meerdere H1-tags. Herzie je kopstructuur!",none:"De tekst bevat geen H1-tag. Voeg er een toe!"}};function We({htmlDocument:s,contentSelector:t}){const e=[...s.querySelectorAll(t)].flatMap(r=>r.tagName.toLowerCase()==="h1"?[r]:[...r.querySelectorAll("h1")]);return{score:e.length===1?9:3,translation:e.length===1?"one":e.length>1?"multiple":"none"}}function Ve({htmlDocument:s,contentSelector:t}){const e=[...s.querySelectorAll(t)].flatMap(i=>i.tagName.toLowerCase()==="img"?[i]:[...i.querySelectorAll("img")]);if(e.length===0)return{score:9,translation:"na"};const o=e.filter(i=>i.getAttribute("alt")===null).length;return{score:o===e.length||o>0?3:9,translation:o===e.length?"none":o>0?"some":"every",...o>0&&{context:{imagesWithoutAltAttribute:o}}}}function Ye({htmlDocument:s,contentSelector:t}){const e=[...s.querySelectorAll(t)].flatMap(a=>["h1","h2","h3","h4","h5","h6"].includes(a.tagName.toLowerCase())?[a]:[...a.querySelectorAll("h1, h2, h3, h4, h5, h6")]);let r=0;const o=[];for(const a of e){const c=Number.parseInt(a.tagName.substring(1),10);c-r>1&&o.push(a),r=c}const i=o.length===0;return{score:i?9:3,translation:i?"sequential":"nonSequential",...!i&&{details:{text:`<ul>${o.map(a=>`<li><strong>${a.tagName}</strong>: ${a.innerText}</li>`).join("")}</ul>`}}}}class Y extends Error{constructor({locale:t,assessment:n,compatibleLocales:e}){super(`Locale ${t.toUpperCase()} is not supported by the assessment ${n}.`),this.locale=t,this.assessment=n,this.compatibleLocales=e}}function re(s,t,n){if(!s)return n;let e,r;if(Array.isArray(t)?e=[...t]:typeof t=="string"?e=t.split("."):typeof t=="symbol"&&(e=[t]),!Array.isArray(e))throw new TypeError(`Expected props to be an array, a string or a symbol, got ${typeof e}`);for(;e.length;)if(r=e.shift(),!s||(s=s[r],s===void 0))return n;return s}function Je(s,t,n){return s.replace(/\{(\w+)\}/g,(e,r)=>t[r.toLowerCase()]||r)}const se={de:Fe,en:Ue,es:Ne,fr:Ke,nl:Ge},Ze={seo:{altAttribute:Ve,headingStructureOrder:Ye,singleH1:We}};function Xe({htmlDocument:s,contentSelector:t,assessments:n,language:e}){const r=se[e]??se.en,o={};for(const[i,a]of Object.entries(Ze)){const c=[];for(const[p,g]of Object.entries(a)){if(n.length>0&&!n.includes(p.toLowerCase()))continue;const{score:h,translation:u,context:v={},details:k}=g({htmlDocument:s,contentSelector:t}),A=re(r,`${p}.${u}`);if(!A)continue;const f=re(r,`${p}._label`,p),m=Object.fromEntries(Object.entries(v).map(([_,S])=>[_.toLowerCase(),S]));c.push({score:h,rating:oe(h),text:`${f}: ${Je(A,m)}`,details:k})}o[i]=c}return o}async function Qe({htmlDocument:s,contentSelector:t,options:n,language:e,logger:r}){var A;const{Paper:o,helpers:i,AnalysisTranslations:a}=await Q("yoastseo"),c=n.language.split("-")[0],p=await et(c);await p.initialize({logLevel:M[n.logLevel]??"info",translations:{default:a[e]??{domain:"wordpress-seo",locale_data:{"wordpress-seo":{"":{}}}}}});const g=nt(s,t);if(n.logLevel>1){t&&(r==null||r.info("Content selector:",t));const f=s.querySelectorAll(t);r==null||r.info("Elements by content selector:",f),r==null||r.info("Analyzing content:",g)}const h=new o(g,{keyword:n.keyword,synonyms:n.synonyms.join(","),slug:new URL(n.url).pathname,permalink:n.url,title:n.title,titleWidth:i.measureTextWidth(n.title),description:n.description,locale:n.language.replace("-","_")}),{result:u}=await p.analyze(h),v=[...u.seo[""].results.map(f=>({...f,_category:"seo"})),...u.readability.results.map(f=>({...f,_category:"readability"}))];n.logLevel>1&&(r==null||r.info("Yoast SEO analysis results:",v));const k={seo:[],readability:[]};for(const f of v){if(!f.text)continue;const m=f._identifier.toLowerCase();if(!qe.some(_=>_.toLowerCase()===m)&&!(!n.keyword&&n.assessments.length===0&&Pe.some(_=>_.toLowerCase()===m))&&!(n.assessments.length>0&&!n.assessments.includes(m))){if(n.assessments.length>0){const _=(A=Object.entries(Me).find(([S])=>S.toLowerCase()===m))==null?void 0:A[1];if(_&&!_.includes(c))throw new Y({locale:c,assessment:f._identifier,compatibleLocales:_})}k[f._category].push({...f,rating:oe(f.score)})}}return k}let H;async function et(s){if(H)return H;const{url:t}=X("worker.js"),{AnalysisWorkerWrapper:n}=await Q("yoastseo"),e=new Worker(t);return e.postMessage({language:s}),H=new n(e),H}function oe(s){return s===-1?"error":s===0?"feedback":s<=4?"bad":s<=7?"ok":s>7?"good":""}async function tt(s){var i,a,c;const n=new DOMParser().parseFromString(s,"text/html");for(const p of Array.from(n.body.querySelectorAll("script, style")))p.remove();let e=n.documentElement.lang||W.en;e.includes("-")||(e=W[e.toLowerCase()]||W.en);const r=n.title||((i=n.querySelector("h1"))==null?void 0:i.innerText)||((a=n.querySelector("h2"))==null?void 0:a.innerText)||"",o=((c=n.querySelector('meta[name="description"]'))==null?void 0:c.content)||"";return{htmlDocument:n,language:e,title:r,description:o}}function nt(s,t){const n=s.querySelectorAll(t);return Array.from(n).map(e=>e.innerHTML).join(`
`)}function ie(){const s=d();N();const t=Ie();async function n(r,o,i){t.info("Starting SEO analysis for",r);const a=await e(r),{htmlDocument:c,language:p,title:g,description:h}=await tt(a);i.assessments=i.assessments.map(f=>{let m=f.toLowerCase();return m.endsWith("assessment")&&(m=m.slice(0,-10)),m});const u=s.translation.code,v=Xe({htmlDocument:c,contentSelector:o,assessments:i.assessments,language:u}),k=await Qe({htmlDocument:c,contentSelector:o,options:{...i,url:r,title:g,description:h,language:p},language:u,logger:t});return{seo:[...v.seo??[],...k.seo??[]],readability:[...v.readability??[],...k.readability??[]]}}async function e(r){if(location.origin===new URL(r).origin){const a=await fetch(r);return a.ok||t.warn(`Response status code ${a.status} for ${r} indicates the page contains an error`),await a.text()}const{code:o,html:i}=await s.api.post("__seo-audit__/proxy",{url:r});return o!==200&&t.warn(`Response status code ${o} for ${r} indicates the page contains an error`),i}return{generateReport:n,fetchHtml:e}}const rt={__name:"RatingStatus",props:{rating:{type:String,required:!0}},setup(s){return{__sfc:!0,RATING_COLOR_MAP:{good:"green",ok:"orange",bad:"red",feedback:"gray"}}}};var st=function(){var t=this,n=t._self._c,e=t._self._setupProxy;return n("div",{staticClass:"ksr-shrink-0 ksr-rounded-full",style:{backgroundColor:`var(--color-${e.RATING_COLOR_MAP[t.rating]}-600)`}})},ot=[],it=E(rt,st,ot);const at=it.exports,lt={__name:"AuditResultItem",props:{result:{type:Object,required:!0},links:{type:Boolean,default:!0}},setup(s){const t=s,n=d(),e=x(()=>{const o=t.result.text.replace(/!$/,".");return t.links?o:r(o)});function r(o){return new DOMParser().parseFromString(o,"text/html").body.textContent||""}return{__sfc:!0,props:t,panel:n,parseText:e,stripTags:r,RatingStatus:at}}};var ct=function(){var t=this,n=t._self._c,e=t._self._setupProxy;return n("div",{staticClass:"ksr-flex ksr-items-start ksr-gap-2"},[n(e.RatingStatus,{staticClass:"ksr-mt-1 ksr-size-3",attrs:{rating:t.result.rating}}),n("div",[n("div",{domProps:{innerHTML:t._s(e.parseText)}}),t.result.details?n("details",[n("summary",{staticClass:"ksr-font-[var(--font-semi)]"},[t._v(" "+t._s(e.panel.t("johannschopplich.seo-audit.issues"))+" ")]),n("k-box",{staticClass:"ksr-my-1",attrs:{"data-theme":"passive",text:t.result.details.text,html:""}})],1):t._e()])],1)},ut=[],dt=E(lt,ct,ut);const pt=dt.exports,ft={__name:"AuditResult",props:{report:{type:Object,required:!0},links:{type:Boolean,default:!0},isDialog:{type:Boolean,default:!1}},setup(s){const t=s,n={good:"green",ok:"orange",bad:"red"},e=d(),r=x(()=>{const o=Object.values(t.report).flat().reduce((i,a)=>(i[a.rating].push(Se(a)),i),{good:[],ok:[],bad:[],feedback:[]});return Object.fromEntries(Object.entries(o).filter(([,i])=>i.length>0))});return{__sfc:!0,props:t,RATING_BADGE_COLOR_MAP:n,panel:e,categorizedReport:r,AuditResultItem:pt}}};var ht=function(){var t=this,n=t._self._c,e=t._self._setupProxy;return n("div",[t._t("header"),n("k-text",{staticClass:"ksr-space-y-4 ksr-pb-2",style:{"--link-color":"var(--color-text)","--link-color-hover":"light-dark(var(--color-blue-800), var(--color-blue-500))"}},t._l(Object.keys(e.categorizedReport),function(r,o){return n("div",{key:r},[n("div",{staticClass:"ksr-mb-2 ksr-inline-flex ksr-items-center"},[n("h3",{staticClass:"ksr-mr-1.5 !ksr-leading-[var(--text-line-height)]",staticStyle:{color:"var(--color-text)","font-size":"var(--text-font-size)"}},[t._v(" "+t._s(e.panel.t(`johannschopplich.seo-audit.rating.${r}`))+" ")]),n("span",{staticClass:"k-seo-audit-badge",attrs:{"data-theme":e.RATING_BADGE_COLOR_MAP[r]}},[t._v(" "+t._s(e.categorizedReport[r].length)+" ")])]),t._l(e.categorizedReport[r],function(i,a){return n(e.AuditResultItem,{key:a,attrs:{result:i,links:t.links}})}),o<Object.keys(e.categorizedReport).length-1?n("hr",{staticClass:"ksr-my-4",style:{background:t.isDialog?void 0:"light-dark(var(--color-gray-350), var(--color-border))"}}):t._e()],2)}),0)],2)},gt=[],mt=E(ft,ht,gt);const ae=mt.exports,yt={__name:"Report",props:{report:{type:Object,required:!0},links:{type:Boolean,default:!0}},emits:["cancel","close","input","submit","success"],setup(s,{emit:t}){const n=d(),e=y();return(async()=>{const r=await V();e.value=r.licenseStatus})(),{__sfc:!0,emit:t,panel:n,licenseStatus:e,LicensingButtonGroup:ne,AuditResult:ae}}};var vt=function(){var t=this,n=t._self._c,e=t._self._setupProxy;return n("k-dialog",{staticClass:"k-seo-audit-report-dialog",attrs:{"cancel-button":!1,"submit-button":!1,visible:!0,size:"large"},on:{cancel:function(r){return e.emit("cancel")}}},[n(e.AuditResult,{attrs:{report:t.report,links:t.links,"is-dialog":""},scopedSlots:t._u([{key:"header",fn:function(){return[n("div",{staticClass:"ksr-mb-4 ksr-flex ksr-items-center ksr-justify-between"},[n("k-text",[n("h2",[t._v(" "+t._s(t.report.seo.length>0&&t.report.readability.length>0?e.panel.t("johannschopplich.seo-audit.results"):t.report.seo.length>0?e.panel.t("johannschopplich.seo-audit.results.seo"):e.panel.t("johannschopplich.seo-audit.results.readability"))+" ")])]),n("div",[e.licenseStatus!==void 0?n(e.LicensingButtonGroup,{attrs:{label:"Kirby SEO Audit","api-namespace":"__seo-audit__","license-status":e.licenseStatus,"pricing-url":"https://kirby.tools/seo-audit/buy"}}):t._e()],1)],1)]},proxy:!0}])})],1)},bt=[],_t=E(yt,vt,bt);const kt=_t.exports,At={blueprint:String,lock:[Boolean,Object],help:String,name:String,parent:String,timestamp:Number};function St(s){return typeof s=="string"?`'${s}'`:new wt().serialize(s)}const wt=(function(){var t;class s{constructor(){fe(this,t,new Map)}compare(e,r){const o=typeof e,i=typeof r;return o==="string"&&i==="string"?e.localeCompare(r):o==="number"&&i==="number"?e-r:String.prototype.localeCompare.call(this.serialize(e,!0),this.serialize(r,!0))}serialize(e,r){if(e===null)return"null";switch(typeof e){case"string":return r?e:`'${e}'`;case"bigint":return`${e}n`;case"object":return this.$object(e);case"function":return this.$function(e)}return String(e)}serializeObject(e){const r=Object.prototype.toString.call(e);if(r!=="[object Object]")return this.serializeBuiltInType(r.length<10?`unknown:${r}`:r.slice(8,-1),e);const o=e.constructor,i=o===Object||o===void 0?"":o.name;if(i!==""&&globalThis[i]===o)return this.serializeBuiltInType(i,e);if(typeof e.toJSON=="function"){const a=e.toJSON();return i+(a!==null&&typeof a=="object"?this.$object(a):`(${this.serialize(a)})`)}return this.serializeObjectEntries(i,Object.entries(e))}serializeBuiltInType(e,r){const o=this["$"+e];if(o)return o.call(this,r);if(typeof(r==null?void 0:r.entries)=="function")return this.serializeObjectEntries(e,r.entries());throw new Error(`Cannot serialize ${e}`)}serializeObjectEntries(e,r){const o=Array.from(r).sort((a,c)=>this.compare(a[0],c[0]));let i=`${e}{`;for(let a=0;a<o.length;a++){const[c,p]=o[a];i+=`${this.serialize(c,!0)}:${this.serialize(p)}`,a<o.length-1&&(i+=",")}return i+"}"}$object(e){let r=q(this,t).get(e);return r===void 0&&(q(this,t).set(e,`#${q(this,t).size}`),r=this.serializeObject(e),q(this,t).set(e,r)),r}$function(e){const r=Function.prototype.toString.call(e);return r.slice(-15)==="[native code] }"?`${e.name||""}()[native]`:`${e.name}(${e.length})${r.replace(/\s*\n\s*/g,"")}`}$Array(e){let r="[";for(let o=0;o<e.length;o++)r+=this.serialize(e[o]),o<e.length-1&&(r+=",");return r+"]"}$Date(e){try{return`Date(${e.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(e){return`ArrayBuffer[${new Uint8Array(e).join(",")}]`}$Set(e){return`Set${this.$Array(Array.from(e).sort((r,o)=>this.compare(r,o)))}`}$Map(e){return this.serializeObjectEntries("Map",e.entries())}}t=new WeakMap;for(const n of["Error","RegExp","URL"])s.prototype["$"+n]=function(e){return`${n}(${e})`};for(const n of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])s.prototype["$"+n]=function(e){return`${n}[${e.join(",")}]`};for(const n of["BigInt64Array","BigUint64Array"])s.prototype["$"+n]=function(e){return`${n}[${e.join("n,")}${e.length>0?"n":""}]`};return s})(),xt=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Lt=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],$t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",O=[];class zt{constructor(){$(this,"_data",new B);$(this,"_hash",new B([...xt]));$(this,"_nDataBytes",0);$(this,"_minBufferSize",0)}finalize(t){t&&this._append(t);const n=this._nDataBytes*8,e=this._data.sigBytes*8;return this._data.words[e>>>5]|=128<<24-e%32,this._data.words[(e+64>>>9<<4)+14]=Math.floor(n/4294967296),this._data.words[(e+64>>>9<<4)+15]=n,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(t,n){const e=this._hash.words;let r=e[0],o=e[1],i=e[2],a=e[3],c=e[4],p=e[5],g=e[6],h=e[7];for(let u=0;u<64;u++){if(u<16)O[u]=t[n+u]|0;else{const S=O[u-15],I=(S<<25|S>>>7)^(S<<14|S>>>18)^S>>>3,z=O[u-2],j=(z<<15|z>>>17)^(z<<13|z>>>19)^z>>>10;O[u]=I+O[u-7]+j+O[u-16]}const v=c&p^~c&g,k=r&o^r&i^o&i,A=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),f=(c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25),m=h+f+v+Lt[u]+O[u],_=A+k;h=g,g=p,p=c,c=a+m|0,a=i,i=o,o=r,r=m+_|0}e[0]=e[0]+r|0,e[1]=e[1]+o|0,e[2]=e[2]+i|0,e[3]=e[3]+a|0,e[4]=e[4]+c|0,e[5]=e[5]+p|0,e[6]=e[6]+g|0,e[7]=e[7]+h|0}_append(t){typeof t=="string"&&(t=B.fromUtf8(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}_process(t){let n,e=this._data.sigBytes/64;t?e=Math.ceil(e):e=Math.max((e|0)-this._minBufferSize,0);const r=e*16,o=Math.min(r*4,this._data.sigBytes);if(r){for(let i=0;i<r;i+=16)this._doProcessBlock(this._data.words,i);n=this._data.words.splice(0,r),this._data.sigBytes-=o}return new B(n,o)}}class B{constructor(t,n){$(this,"words");$(this,"sigBytes");t=this.words=t||[],this.sigBytes=n===void 0?t.length*4:n}static fromUtf8(t){const n=unescape(encodeURIComponent(t)),e=n.length,r=[];for(let o=0;o<e;o++)r[o>>>2]|=(n.charCodeAt(o)&255)<<24-o%4*8;return new B(r,e)}toBase64(){const t=[];for(let n=0;n<this.sigBytes;n+=3){const e=this.words[n>>>2]>>>24-n%4*8&255,r=this.words[n+1>>>2]>>>24-(n+1)%4*8&255,o=this.words[n+2>>>2]>>>24-(n+2)%4*8&255,i=e<<16|r<<8|o;for(let a=0;a<4&&n*8+a*6<this.sigBytes*8;a++)t.push($t.charAt(i>>>6*(3-a)&63))}return t.join("")}concat(t){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let n=0;n<t.sigBytes;n++){const e=t.words[n>>>2]>>>24-n%4*8&255;this.words[this.sigBytes+n>>>2]|=e<<24-(this.sigBytes+n)%4*8}else for(let n=0;n<t.sigBytes;n+=4)this.words[this.sigBytes+n>>>2]=t.words[n>>>2];this.sigBytes+=t.sigBytes}}function Ct(s){return new zt().finalize(s).toBase64()}function Rt(s){return Ct(St(s))}function Et(...s){return`${He}${Rt([...s])}`}const le={...At},Ot=Object.assign({inheritAttrs:!1},{__name:"SeoAudit",props:le,setup(s){const t=s,n=U(),e=d(),r=b(),{t:o}=ge(),{generateReport:i}=ie(),a=Et(e.view.path);let c;const p=y(),g=y(),h=y(),u=y(),v=y(),k=y(),A=y(),f=y(),m=y(),_=y(),S=y(!1),I=y(!1),z=y(),j=y(),{currentContent:J}=N(),ce=x(()=>g.value||J.value[h.value]||""),ue=x(()=>{if(!u.value&&!v.value)return[];const C=u.value||J.value[v.value];return Array.isArray(C)?C:typeof C=="string"?C.split(",").map(w=>w.trim()):[]});we(()=>e.language.code,()=>{Z()}),Z(!0);const{format:Ft}=new Intl.DateTimeFormat(e.translation.code.replace("_","-"),{dateStyle:"short",timeStyle:"short"});async function Z(C=!1){const{load:w}=me(),[F,L]=await Promise.all([V(),w({parent:t.parent,name:t.name})]);if(C){if(p.value=o(L.label)||e.t("johannschopplich.seo-audit.label"),h.value=L.keyphraseField,v.value=L.synonymsField,k.value=L.assessments,A.value=L.contentSelector,f.value=L.links,m.value=L.persisted,_.value=M.indexOf(F.config.logLevel||L.logLevel),z.value=F.licenseStatus,m.value){const de=JSON.parse(localStorage.getItem(a));de&&(j.value=de)}S.value=!0}g.value=L.keyphrase,u.value=L.synonyms,c=(await r.get(e.view.path,{select:"previewUrl"})).previewUrl}async function Ut(){const C=c;e.isLoading=!0,I.value=!0;try{const w=await i(C,A.value,{assessments:k.value,logLevel:_.value,keyword:ce.value,synonyms:ue.value});j.value={result:w,timestamp:Date.now()},m.value&&localStorage.setItem(a,JSON.stringify(j.value))}catch(w){console.error(w),w instanceof Y?e.notification.error(e.t("johannschopplich.seo-audit.error.incompatibleLocale",{locale:w.locale.toUpperCase(),assessment:w.assessment,compatibleLocales:w.compatibleLocales.map(F=>F.toUpperCase()).join(", ")})):e.notification.error(e.t("johannschopplich.seo-audit.analyze.error"))}e.isLoading=!1,I.value=!1,e.notification.success({icon:"check",message:e.t("johannschopplich.seo-audit.analyze.success")})}return{__sfc:!0,propsDefinition:le,props:t,_isKirby5:n,panel:e,api:r,t:o,generateReport:i,storageKey:a,previewUrl:c,label:p,keyphrase:g,keyphraseField:h,synonyms:u,synonymsField:v,assessments:k,contentSelector:A,links:f,persisted:m,logLevel:_,isInitialized:S,isAnalyzing:I,licenseStatus:z,report:j,currentContent:J,resolvedKeyphrase:ce,resolvedSynonyms:ue,format:Ft,updateSectionData:Z,analyze:Ut,LicensingButtonGroup:ne,AuditResult:ae}}});var Bt=function(){var t=this,n=t._self._c,e=t._self._setupProxy;return e.isInitialized?n("k-section",{attrs:{label:e.label}},[e.licenseStatus!==void 0?n("template",{slot:"options"},[n(e.LicensingButtonGroup,{attrs:{label:"Kirby SEO Audit","api-namespace":"__seo-audit__","license-status":e.licenseStatus,"pricing-url":"https://kirby.tools/seo-audit/buy"}})],1):t._e(),n("div",{staticClass:"ksr-space-y-4"},[n("k-button-group",{attrs:{layout:"collapsed"}},[n("k-button",{attrs:{icon:e.isAnalyzing?"loader":"seo-audit-analyze",text:e.panel.t("johannschopplich.seo-audit.analyze"),variant:"filled",theme:"positive",disabled:e.isAnalyzing},on:{click:function(r){return e.analyze()}}})],1),e.report?n("div",[n("k-box",{class:[e.isAnalyzing&&"ksr-cusor-wait ksr-pointer-events-none ksr-animate-pulse"],style:e._isKirby5?{"--box-color-text":"light-dark(var(--theme-color-900), var(--color-gray-200))","--box-color-back":"light-dark(var(--color-gray-250), var(--theme-color-back))"}:void 0,attrs:{theme:"passive"}},[n(e.AuditResult,{class:[e.isAnalyzing&&"ksr-opacity-50"],attrs:{report:e.report.result,links:e.links}})],1),n("k-box",{staticClass:"ksr-border-transparent",attrs:{theme:"empty",icon:"clock"}},[t._v(" "+t._s(e.format(e.report.timestamp))+" ")])],1):t._e()],1)],2):t._e()},jt=[],Tt=E(Ot,Bt,jt);const It=Tt.exports,qt={__name:"SeoAuditButton",props:{keyphrase:{type:String,default:""},keyphraseField:{type:String,default:""},synonyms:{type:String,default:""},synonymsField:{type:String,default:""},assessments:{type:Array,default:()=>[]},contentSelector:{type:String,default:"body"},links:{type:Boolean,default:!0},logLevel:{type:String,default:"warn",validator:s=>M.includes(s)}},setup(s){const t=s,n=d(),e=b(),{generateReport:r}=ie(),o=y(!1),{currentContent:i}=N();async function a(){n.isLoading=!0,o.value=!0;const c=await V(),p=(await e.get(n.view.path,{select:"previewUrl"})).previewUrl,g=t.keyphrase||i.value[t.keyphraseField]||"";let h=[];if(t.synonyms||t.synonymsField){const u=t.synonyms||i.value[t.synonymsField];Array.isArray(u)?h=u:typeof u=="string"&&(h=u.split(",").map(v=>v.trim()))}try{const u=await r(p,t.contentSelector||"body",{assessments:t.assessments,logLevel:M.indexOf(c.config.logLevel||t.logLevel||"warn"),keyword:g,synonyms:h});n.dialog.open({component:"k-seo-audit-report-dialog",props:{report:u,links:t.links}})}catch(u){console.error(u),u instanceof Y?n.notification.error(n.t("johannschopplich.seo-audit.error.incompatibleLocale",{locale:u.locale.toUpperCase(),assessment:u.assessment,compatibleLocales:u.compatibleLocales.map(v=>v.toUpperCase()).join(", ")})):n.notification.error(n.t("johannschopplich.seo-audit.analyze.error"))}finally{n.isLoading=!1,o.value=!1}}return{__sfc:!0,props:t,panel:n,api:e,generateReport:r,isAnalyzing:o,currentContent:i,analyze:a}}};var Pt=function(){var t=this,n=t._self._c,e=t._self._setupProxy;return n("k-button",{attrs:{icon:e.isAnalyzing?"loader":"seo-audit-analyze",text:e.panel.t("johannschopplich.seo-audit.label"),theme:"positive",variant:"filled",size:"sm",responsive:""},on:{click:function(r){return e.analyze()}}})},Mt=[],Dt=E(qt,Pt,Mt);const Ht=Dt.exports;window.panel.plugin("johannschopplich/seo-audit",{viewButtons:{"seo-audit":Ht},components:{"k-seo-audit-report-dialog":kt},sections:{"seo-audit":It},icons:{"seo-audit-analyze":'<path d="M8 3a7 7 0 0 0 0 14h1.07a7.06 7.06 0 0 1 0-2H8A5 5 0 0 1 8 5h8a5 5 0 0 1 4.9 6a7.021 7.021 0 0 1 1.426 2A7 7 0 0 0 16 3zm8 10a3 3 0 1 0 0 6a3 3 0 0 0 0-6m-5 3a5 5 0 1 1 9.172 2.757l2.535 2.536l-1.414 1.414l-2.536-2.535A5 5 0 0 1 11 16" />'}})})();
